# Migration `20201025014741-category`

This migration has been generated by Samuel Cook at 10/24/2020, 8:47:41 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
PRAGMA foreign_keys=OFF;
CREATE TABLE "new_Category" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "name" TEXT NOT NULL
);
INSERT INTO "new_Category" ("id", "name") SELECT "id", "name" FROM "Category";
DROP TABLE "Category";
ALTER TABLE "new_Category" RENAME TO "Category";
CREATE TABLE "new_Event" (
    "id" TEXT NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" DATETIME NOT NULL,
    "name" TEXT NOT NULL,
    "title" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "datetime" DATETIME NOT NULL,
    "duration" INTEGER NOT NULL,
    "online" BOOLEAN NOT NULL DEFAULT true,
    "location" TEXT NOT NULL,
    "userId" INTEGER,
    "categoryId" INTEGER,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE,
    FOREIGN KEY ("categoryId") REFERENCES "Category"("id") ON DELETE SET NULL ON UPDATE CASCADE,
PRIMARY KEY ("id")
);
INSERT INTO "new_Event" ("id", "createdAt", "updatedAt", "name", "title", "description", "datetime", "duration", "online", "location", "userId") SELECT "id", "createdAt", "updatedAt", "name", "title", "description", "datetime", "duration", "online", "location", "userId" FROM "Event";
DROP TABLE "Event";
ALTER TABLE "new_Event" RENAME TO "Event";
PRAGMA foreign_key_check;
PRAGMA foreign_keys=ON
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201025010218-categories..20201025014741-category
--- datamodel.dml
+++ datamodel.dml
@@ -4,15 +4,15 @@
 // In case you don't want to set up docker and docker-compose:
 // 1. Comment this datasource
 // datasource db {
 //   provider = "postgresql"
-//   url = "***"
+//   url = "***"
 // }
 // 2. Uncomment this datasource
 datasource sqlite {
   provider = "sqlite"
-  url = "***"
+  url = "***"
   //use this on local
 }
 generator client {
@@ -47,25 +47,25 @@
   privateData        String?
 }
 model Category {
-  id      Int     @id @default(autoincrement())
-  name    String
-  Event   Event?  @relation(fields: [eventId], references: [id])
-  eventId String?
+  id     Int     @id @default(autoincrement())
+  name   String
+  events Event[]
 }
 model Event {
-  id          String     @id @default(uuid())
-  createdAt   DateTime   @default(now())
-  updatedAt   DateTime   @updatedAt
-  categories  Category[]
+  id          String    @id @default(uuid())
+  createdAt   DateTime  @default(now())
+  updatedAt   DateTime  @updatedAt
   name        String
   title       String
   description String
   datetime    DateTime
   duration    Int // integer represents minutes
-  online      Boolean    @default(true)
+  online      Boolean   @default(true)
   location    String
-  User        User?      @relation(fields: [userId], references: [id])
+  User        User?     @relation(fields: [userId], references: [id])
   userId      Int?
+  Category    Category? @relation(fields: [categoryId], references: [id])
+  categoryId  Int?
 }
```


